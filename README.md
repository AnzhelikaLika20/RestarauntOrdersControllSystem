# Система управления заказами в ресторане

## Общая информация

Система разделена на несколько слоев: presentation, data, services

1. **Presentation**
   - Отвечает за взаимодействие с пользователем, получает и обрабатывает ввод пользователя, выводит подсказки в консоль

2. **Data**
   - Отвечает за хранение информации в системе: зарегистрированных пользователей, созданные заказы, полученные отзывы пользователей, доступные блюда в меню, а также некоторую статистическую информацию о работе ресторана. В хранилищах используются json сериализация и десериализация, что позволяет сохранять состояние программы после завершения сессии и восстанавливать их при повторном запуске.

3. **Services**
   - Слой, в котором размещена основная логика, в нем также происходит валидация полученной от пользователя информации. Из презентационного слоя данные передаются в сервис, валидируются. Взаимодействие осуществляется по средствам передачи моделей ResponseX, которые содержат код ответа, текстовое сообщение. Далее данные при необходимости сохраняются/обновляются в одном из хранилищ в data слое

## Сервисы

1. **Сервис авторизации (AuthService)**
   - Используется для регистрации и аутентификации пользователей. В системе доступны 2 типа пользователей: посетители и администраторы. Для обеспечения безопасного хранения паролей используется хеширование паролей с помощью библиотеки `org.mindrot.jbcrypt.BCrypt`.

2. **Сервис для работы с меню (MenuService)**
   - Содержит методы для работы с меню ресторана, актуальные для администраторов заведения (добавление блюда, изменение параметров блюд и т.д.). Пользователям, зарегистрированным как посетители, данный функционал недоступен.

3. **Сервис заказов (OrderService)**
   - Отвечает за создание и обработку заказов. Функционал этого сервиса доступен только для посетителей ресторана. Пользователи могут создавать заказы, добавлять блюда в заказ и отменять заказ, если он находится в статусе "Preparing". Когда по истечение времени приготовления заказ переходит в статус "Ready", пользователь может оплатить заказ. В приложении реализована параллельная обработка заказов, приоритет обработки заказов – очередность создания заказов. Длительность приготовления заказа вычисляется как максимальное время приготовления среди всех блюд в заказе. В системе длительность приготовления заказа измеряется в минутах, но для наглядности процесса приготовления и работы системы заказ готовится быстрее. Например, если время приготовления заказа 20 минут, то в системе заказ будет готовиться 20 секунд.

4. **Сервис отзывов (ReviewService)**
   - Отвечает за систему отзывов в ресторане. Пользователи могут оставить отзыв на конкретное блюдо, а администраторам доступна вся информация об отзывах пользователей.

5. **Сервис статистики (StatisticsService)**
   - Отвечает за получение статистики (выручка ресторана, информация о самых популярных блюдах, средняя оценка блюд, количество заказов в ресторане за определенный период). В `StatisticsRepository` сохраняется и сериализуется сумма выручки, другие статистические метрики вычисляются по мере необходимости (запроса от администраторов). Потенциально можно добавлять другие метрики для сохранения в репозиторий статистики.

## Используемые паттерны

- Factory (в системе меню)
- Singleton (в dependency injection)
- Chain of Responsibility (используется для последовательной валидации запросов с сервисы)
